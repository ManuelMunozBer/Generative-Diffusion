

<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modelos &mdash; documentación de generative_diffusion - 1.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4936afed"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=f85f4cfb"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="prev" title="Generative Diffusion: Entrenamiento y Generación con MNIST a Color" href="simple_demo.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            generative_diffusion
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html">Generative Diffusion: Entrenamiento y Generación con MNIST a Color</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html#1.-Cargar-y-preparar-un-dataset-MNIST-a-color">1. Cargar y preparar un dataset MNIST a color</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html#2.-Configurar-el-modelo-de-difusión">2. Configurar el modelo de difusión</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html#3.-Entrenar-el-modelo">3. Entrenar el modelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html#4.-Generar-imágenes-del-dígito-especificado">4. Generar imágenes del dígito especificado</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_demo.html#5.-Generar-imágenes-de-dígitos-a-color-de-una-clase-específica-con-imputación">5. Generar imágenes de dígitos a color de una clase específica con imputación</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modelos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#VE">VE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Euler-Maruyama">Euler Maruyama</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Predictor---Corrector">Predictor - Corrector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Flow-ODE">Flow ODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Exponential-Integrator">Exponential Integrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#VP---Linear">VP - Linear</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Euler Maruyama</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Predictor-corrector">Predictor corrector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Flow ODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Exponential Integrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#VP---Cosine">VP - Cosine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Euler Maruyama</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Predictor - Corrector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Flow ODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Exponential Integrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SubVP---Linear">SubVP - Linear</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Euler Maruyama</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">Predictor - Corrector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">Flow ODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Exponential Integrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SubVP---Cosine">SubVP - Cosine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">Euler Maruyama</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Predictor---corrector">Predictor - corrector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">Flow ODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">Exponential Integrator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Imputation">Imputation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#VE---Flow-ODE">VE - Flow ODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#VP-Linear---Exponencial-Integrator">VP Linear - Exponencial Integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#VP-Cosine---Predictor-Corrector">VP Cosine - Predictor Corrector</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Comparativa-Hiperparámetros">Comparativa Hiperparámetros</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#SubVP-Cosine---Exponential-Integrator">SubVP Cosine - Exponential Integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SubVP-Cosine-Flow-ODE">SubVP Cosine Flow ODE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Comparación-métricas-según-número-de-épocas-entrenamiento">Comparación métricas según número de épocas entrenamiento</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id17">VE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Pruebas-Imputation">Pruebas Imputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Visualizar-proceso-de-eliminación-de-ruido">Visualizar proceso de eliminación de ruido</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">generative_diffusion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Modelos</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/pruebas_validacion.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip install generative_diffusion # Instalación el paquete desarrollado</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Por si se quiere usar los archivos locales en vez de el paquete instalado</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">))</span>  <span class="c1"># Añadir raíz del proyecto al path</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar componentes del framework de difusión</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.utils</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.diffusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.score_networks</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScoreNet</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configurar parámetros</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">N_EPOCHS</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">CHECKPOINT_INTERVAL</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Lambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Lambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;../data&#39;</span><span class="p">,</span>
                         <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

<span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualizar un batch de imágenes</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">,</span> <span class="n">n_images</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Imágenes del dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_4_0.png" src="../_images/notebooks_pruebas_validacion_4_0.png" />
</div>
</div>
<section id="Modelos">
<h1>Modelos<a class="headerlink" href="#Modelos" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="VE">
<h2>VE<a class="headerlink" href="#VE" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;probability_flow_ode&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:14:58,611 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N_EPOCHS = 30</span>
<span class="c1"># print(f&quot;Entrenando el modelo por {N_EPOCHS} epochs...&quot;)</span>

<span class="c1"># # Función para mostrar el progreso del entrenamiento</span>
<span class="c1"># def training_callback(model, epoch, history):</span>
<span class="c1">#     print(f&quot;Epoch {epoch+1}, Loss: {history[&#39;loss&#39;][-1]:.6f}&quot;)</span>

<span class="c1"># # Entrenar el modelo</span>
<span class="c1"># training_history = diffusion_model_ve.train(</span>
<span class="c1">#     dataloader=train_dataloader,</span>
<span class="c1">#     n_epochs=N_EPOCHS,</span>
<span class="c1">#     lr=LR,</span>
<span class="c1">#     checkpoint_interval=CHECKPOINT_INTERVAL,</span>
<span class="c1">#     callback=training_callback,</span>
<span class="c1">#     model_file_name = &quot;ve_sde&quot;</span>
<span class="c1"># )</span>
<span class="c1"># plot_training_history(training_history, title=&quot;Pérdida del modelo de difusión&quot;)</span>
</pre></div>
</div>
</div>
<section id="Euler-Maruyama">
<h3>Euler Maruyama<a class="headerlink" href="#Euler-Maruyama" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;euler_maruyama&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:57:43,336 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:57:44,255 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-11 10:57:44,279 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:57:44,279 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:57:44,296 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:57:44,298 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_ve_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_ve_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VE: Euler Maruyama&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:59:17,957 — DiffusionModel — INFO — Generando 8 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 0...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_12_2.png" src="../_images/notebooks_pruebas_validacion_12_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_ve_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_ve_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con difusión&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-yellow-fg">2025-05-10 23:15:20,769 — DiffusionModel — WARNING — No se proporcionó condición, se usará un tensor aleatorio de condición</span>
<span class="ansi-green-fg">2025-05-10 23:15:20,770 — DiffusionModel — INFO — Generando 16 muestras con 5000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_13_1.png" src="../_images/notebooks_pruebas_validacion_13_1.png" />
</div>
</div>
</section>
<section id="Predictor---Corrector">
<h3>Predictor - Corrector<a class="headerlink" href="#Predictor---Corrector" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;predictor_corrector&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:16:08,720 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_ve_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:16:08,754 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-10 23:16:08,759 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:16:08,759 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:16:08,771 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:16:08,775 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_ve_predictor</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_ve_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_ve_predictor</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VE: Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:16:08,786 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_17_2.png" src="../_images/notebooks_pruebas_validacion_17_2.png" />
</div>
</div>
</section>
<section id="Flow-ODE">
<h3>Flow ODE<a class="headerlink" href="#Flow-ODE" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;probability_flow_ode&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:10,379 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_ve_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:10,416 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-10 23:19:10,421 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:19:10,422 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:19:10,432 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:19:10,435 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_ve_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_ve_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_ve_flow_ode</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VE: Flow ODE&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:10,447 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 9...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_21_2.png" src="../_images/notebooks_pruebas_validacion_21_2.png" />
</div>
</div>
</section>
<section id="Exponential-Integrator">
<h3>Exponential Integrator<a class="headerlink" href="#Exponential-Integrator" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;exponential_integrator&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:42,387 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_ve_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:42,424 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-10 23:19:42,428 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:19:42,429 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:19:42,442 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:19:42,444 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_ve_exponential</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_ve_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_ve_exponential</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VE: Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:19:42,457 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_25_2.png" src="../_images/notebooks_pruebas_validacion_25_2.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="VP---Linear">
<h2>VP - Linear<a class="headerlink" href="#VP---Linear" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:00,319 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N_EPOCHS = 32</span>
<span class="c1"># print(f&quot;Entrenando el modelo por {N_EPOCHS} epochs...&quot;)</span>

<span class="c1"># # Función para mostrar el progreso del entrenamiento</span>
<span class="c1"># def training_callback(model, epoch, history):</span>
<span class="c1">#     print(f&quot;Epoch {epoch+1}, Loss: {history[&#39;loss&#39;][-1]:.6f}&quot;)</span>

<span class="c1"># # Entrenar el modelo</span>
<span class="c1"># training_history = diffusion_model_vp_linear.train(</span>
<span class="c1">#     dataloader=train_dataloader,</span>
<span class="c1">#     n_epochs=N_EPOCHS,</span>
<span class="c1">#     lr=LR,</span>
<span class="c1">#     checkpoint_interval=CHECKPOINT_INTERVAL,</span>
<span class="c1">#     callback=training_callback,</span>
<span class="c1">#     model_file_name = &quot;vp_sde_linear&quot;</span>
<span class="c1"># )</span>
<span class="c1"># plot_training_history(training_history, title=&quot;Pérdida del modelo de difusión&quot;)</span>
</pre></div>
</div>
</div>
<section id="id1">
<h3>Euler Maruyama<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:00,364 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_linear_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:00,373 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:20:00,399 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:20:00,400 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:20:00,409 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:20:00,411 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_linear_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_linear_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_linear_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Linear: Euler-Maruyama&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:00,423 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 8...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_32_2.png" src="../_images/notebooks_pruebas_validacion_32_2.png" />
</div>
</div>
</section>
<section id="Predictor-corrector">
<h3>Predictor corrector<a class="headerlink" href="#Predictor-corrector" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:21,443 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_linear_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:21,459 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:20:21,464 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:20:21,464 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:20:21,474 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:20:21,477 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_linear_predictor</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_linear_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_linear_predictor</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Linear: Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:20:21,487 — DiffusionModel — INFO — Generando 12 muestras con 1000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_36_2.png" src="../_images/notebooks_pruebas_validacion_36_2.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Flow ODE<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.05</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:21:51,176 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_linear_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:21:51,212 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:21:51,217 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:21:51,218 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:21:51,230 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:21:51,233 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_linear_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_flow_ode</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Linear: Flow ODE&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:21:51,245 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 0...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_40_2.png" src="../_images/notebooks_pruebas_validacion_40_2.png" />
</div>
</div>
</section>
<section id="id4">
<h3>Exponential Integrator<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:31,059 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_linear_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:31,096 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:22:31,099 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:22:31,100 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:22:31,110 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:22:31,114 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_exponential_integrator</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_linear_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_exponential_integrator</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Linear: Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:31,123 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 4...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_44_2.png" src="../_images/notebooks_pruebas_validacion_44_2.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="VP---Cosine">
<h2>VP - Cosine<a class="headerlink" href="#VP---Cosine" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:52,039 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N_EPOCHS = 34</span>
<span class="c1"># print(f&quot;Entrenando el modelo por {N_EPOCHS} epochs...&quot;)</span>

<span class="c1"># # Función para mostrar el progreso del entrenamiento</span>
<span class="c1"># def training_callback(model, epoch, history):</span>
<span class="c1">#     print(f&quot;Epoch {epoch+1}, Loss: {history[&#39;loss&#39;][-1]:.6f}&quot;)</span>

<span class="c1"># # Entrenar el modelo</span>
<span class="c1"># training_history = diffusion_model_vp_cosine.train(</span>
<span class="c1">#     dataloader=train_dataloader,</span>
<span class="c1">#     n_epochs=N_EPOCHS,</span>
<span class="c1">#     lr=LR,</span>
<span class="c1">#     checkpoint_interval=CHECKPOINT_INTERVAL,</span>
<span class="c1">#     callback=training_callback,</span>
<span class="c1">#     model_file_name = &quot;vp_sde_cosine&quot;</span>
<span class="c1"># )</span>
<span class="c1"># plot_training_history(training_history, title=&quot;Pérdida del modelo de difusión&quot;)</span>
</pre></div>
</div>
</div>
<section id="id5">
<h3>Euler Maruyama<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:52,084 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_cosine_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:52,090 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:22:52,113 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:22:52,114 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:22:52,122 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:22:52,124 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_cosine_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_cosine_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Cosine: Euler Maruyama&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:22:52,136 — DiffusionModel — INFO — Generando 12 muestras con 3000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 2...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_51_2.png" src="../_images/notebooks_pruebas_validacion_51_2.png" />
</div>
</div>
</section>
<section id="id6">
<h3>Predictor - Corrector<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:23:16,820 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_cosine_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:23:16,856 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:23:16,860 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:23:16,862 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:23:16,871 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:23:16,876 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_cosine_predictor</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_cosine_predictor</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Cosine: Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:23:16,885 — DiffusionModel — INFO — Generando 12 muestras con 1000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 6...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_55_2.png" src="../_images/notebooks_pruebas_validacion_55_2.png" />
</div>
</div>
</section>
<section id="id7">
<h3>Flow ODE<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:43,701 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:43,737 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:24:43,742 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:24:43,743 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:24:43,751 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:24:43,754 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_cosine_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_cosine_flow_ode</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Cosine: Flow ODE&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:43,766 — DiffusionModel — INFO — Generando 12 muestras con 1000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 9...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_59_2.png" src="../_images/notebooks_pruebas_validacion_59_2.png" />
</div>
</div>
</section>
<section id="id8">
<h3>Exponential Integrator<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:59,781 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:59,824 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:24:59,828 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:24:59,830 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:24:59,839 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:24:59,842 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_vp_cosine_exponential</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_vp_cosine_exponential</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con VP Cosine: Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:24:59,854 — DiffusionModel — INFO — Generando 12 muestras con 3000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_63_2.png" src="../_images/notebooks_pruebas_validacion_63_2.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="SubVP---Linear">
<h2>SubVP - Linear<a class="headerlink" href="#SubVP---Linear" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:25,562 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N_EPOCHS = 34</span>
<span class="c1"># print(f&quot;Entrenando el modelo por {N_EPOCHS} epochs...&quot;)</span>

<span class="c1"># # Función para mostrar el progreso del entrenamiento</span>
<span class="c1"># def training_callback(model, epoch, history):</span>
<span class="c1">#     print(f&quot;Epoch {epoch+1}, Loss: {history[&#39;loss&#39;][-1]:.6f}&quot;)</span>

<span class="c1"># # Entrenar el modelo</span>
<span class="c1"># training_history = diffusion_model_subvp_linear.train(</span>
<span class="c1">#     dataloader=train_dataloader,</span>
<span class="c1">#     n_epochs=N_EPOCHS,</span>
<span class="c1">#     lr=LR,</span>
<span class="c1">#     checkpoint_interval=CHECKPOINT_INTERVAL,</span>
<span class="c1">#     callback=training_callback,</span>
<span class="c1">#     model_file_name = &quot;subvp_sde_linear&quot;</span>
<span class="c1"># )</span>
<span class="c1"># plot_training_history(training_history, title=&quot;Pérdida del modelo de difusión&quot;)</span>
</pre></div>
</div>
</div>
<section id="id9">
<h3>Euler Maruyama<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.22</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:25,609 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_linear_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:25,617 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:25:25,647 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:25:25,647 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:25:25,655 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:25:25,658 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_linear_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_linear_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_linear_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Linear: Euler Maruyama&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:25,669 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 0...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_70_2.png" src="../_images/notebooks_pruebas_validacion_70_2.png" />
</div>
</div>
</section>
<section id="id10">
<h3>Predictor - Corrector<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:42,345 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_linear_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:42,384 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:25:42,388 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:25:42,389 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:25:42,405 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:25:42,407 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_linear_predictor</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_linear_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_linear_predictor</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Linear: Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:25:42,419 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_74_2.png" src="../_images/notebooks_pruebas_validacion_74_2.png" />
</div>
</div>
</section>
<section id="id11">
<h3>Flow ODE<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.05</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:29:27,806 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_linear_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:29:27,841 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:29:27,845 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:29:27,846 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:29:27,858 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:29:27,860 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_linear_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_linear_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_linear_flow_ode</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Linear: Flow ODE&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:29:27,872 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 0...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_78_2.png" src="../_images/notebooks_pruebas_validacion_78_2.png" />
</div>
</div>
</section>
<section id="id12">
<h3>Exponential Integrator<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:07,432 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_linear_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:07,466 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:30:07,471 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:30:07,472 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:30:07,483 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:30:07,486 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_linear_exponential</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_linear_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_linear_exponential</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Linear: Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:07,495 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 4...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_82_2.png" src="../_images/notebooks_pruebas_validacion_82_2.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="SubVP---Cosine">
<h2>SubVP - Cosine<a class="headerlink" href="#SubVP---Cosine" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:28,786 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N_EPOCHS = 38</span>
<span class="c1"># print(f&quot;Entrenando el modelo por {N_EPOCHS} epochs...&quot;)</span>

<span class="c1"># # Función para mostrar el progreso del entrenamiento</span>
<span class="c1"># def training_callback(model, epoch, history):</span>
<span class="c1">#     print(f&quot;Epoch {epoch+1}, Loss: {history[&#39;loss&#39;][-1]:.6f}&quot;)</span>

<span class="c1"># # Entrenar el modelo</span>
<span class="c1"># training_history = diffusion_model_subvp_cosine.train(</span>
<span class="c1">#     dataloader=train_dataloader,</span>
<span class="c1">#     n_epochs=N_EPOCHS,</span>
<span class="c1">#     lr=LR,</span>
<span class="c1">#     checkpoint_interval=CHECKPOINT_INTERVAL,</span>
<span class="c1">#     callback=training_callback,</span>
<span class="c1">#     model_file_name = &quot;subvp_sde_cosine&quot;</span>
<span class="c1"># )</span>
<span class="c1"># plot_training_history(training_history, title=&quot;Pérdida del modelo de difusión&quot;)</span>
</pre></div>
</div>
</div>
<section id="id13">
<h3>Euler Maruyama<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.52</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:28,820 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_cosine_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:28,828 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:30:28,854 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:30:28,855 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:30:28,865 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:30:28,867 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_euler</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_euler</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Euler Maruyama&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:28,876 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 1...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_89_2.png" src="../_images/notebooks_pruebas_validacion_89_2.png" />
</div>
</div>
</section>
<section id="Predictor---corrector">
<h3>Predictor - corrector<a class="headerlink" href="#Predictor---corrector" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.05</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:45,681 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_cosine_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:45,716 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:30:45,719 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:30:45,720 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:30:45,730 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:30:45,733 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_predictor</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_predictor</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:30:45,742 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_93_2.png" src="../_images/notebooks_pruebas_validacion_93_2.png" />
</div>
</div>
</section>
<section id="id15">
<h3>Flow ODE<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.58</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.46</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:33:40,046 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:33:40,090 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:33:40,097 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:33:40,098 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:33:40,111 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:33:40,115 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Flow ODE&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:33:40,126 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_97_2.png" src="../_images/notebooks_pruebas_validacion_97_2.png" />
</div>
</div>
</section>
<section id="id16">
<h3>Exponential Integrator<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.42</span><span class="p">},</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:10,598 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:10,632 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:34:10,638 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:34:10,639 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:34:10,651 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:34:10,654 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:10,665 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 9...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_101_2.png" src="../_images/notebooks_pruebas_validacion_101_2.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="Imputation">
<h1>Imputation<a class="headerlink" href="#Imputation" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
<section id="VE---Flow-ODE">
<h2>VE - Flow ODE<a class="headerlink" href="#VE---Flow-ODE" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_flow_ode_imputation</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:31,586 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_ve_flow_ode_imputation</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:31,595 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-10 23:34:31,601 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:34:31,602 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:34:31,614 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:34:31,617 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.controllable</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_mask</span>

<span class="c1"># Obtener un batch de imágenes del dataloader</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>

<span class="c1"># mask = center_square_mask(images, keep_ratio=0.4)</span>
<span class="c1"># mask = border_mask(images, border_ratio=0.3)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">random_mask</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputando las imágenes enmascaradas...&quot;</span><span class="p">)</span>
<span class="c1"># Realizar la imputación</span>
<span class="n">imputed_images</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span> <span class="n">diffusion_model_ve_flow_ode_imputation</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
    <span class="n">image</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Mostrar resultados de imputación</span>
<span class="n">show_imputation_results</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">imputed_images</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Resultados de imputación: VE, Flow ODE&quot;</span><span class="p">,</span> <span class="n">original_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">imputed_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:31,638 — DiffusionModel — INFO — Generando 8 muestras con 500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Imputando las imágenes enmascaradas...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_107_2.png" src="../_images/notebooks_pruebas_validacion_107_2.png" />
</div>
</div>
</section>
<section id="VP-Linear---Exponencial-Integrator">
<h2>VP Linear - Exponencial Integrator<a class="headerlink" href="#VP-Linear---Exponencial-Integrator" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_exponential_integrator_imputation</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:38,517 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_linear_exponential_integrator_imputation</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:38,546 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-10 23:34:38,554 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:34:38,554 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:34:38,566 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:34:38,569 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.controllable</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_mask</span>

<span class="c1"># Obtener un batch de imágenes del dataloader</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>

<span class="c1"># mask = center_square_mask(images, keep_ratio=0.4)</span>
<span class="c1"># mask = border_mask(images, border_ratio=0.3)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">random_mask</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputando las imágenes enmascaradas...&quot;</span><span class="p">)</span>
<span class="c1"># Realizar la imputación</span>
<span class="n">imputed_images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diffusion_model_vp_linear_exponential_integrator_imputation</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
    <span class="n">image</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Mostrar resultados de imputación</span>
<span class="n">show_imputation_results</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">imputed_images</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Resultados de imputación: VP Linear, Exponential Integrator&quot;</span><span class="p">,</span> <span class="n">original_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">imputed_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:38,589 — DiffusionModel — INFO — Generando 8 muestras con 500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Imputando las imágenes enmascaradas...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_111_2.png" src="../_images/notebooks_pruebas_validacion_111_2.png" />
</div>
</div>
</section>
<section id="VP-Cosine---Predictor-Corrector">
<h2>VP Cosine - Predictor Corrector<a class="headerlink" href="#VP-Cosine---Predictor-Corrector" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_predictor_corrector_imputation</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:42,468 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado</span>
<span class="n">diffusion_model_vp_cosine_predictor_corrector_imputation</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:42,503 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:34:42,508 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:34:42,510 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:34:42,520 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:34:42,523 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.controllable</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_mask</span>

<span class="c1"># Obtener un batch de imágenes del dataloader</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>

<span class="c1"># mask = center_square_mask(images, keep_ratio=0.4)</span>
<span class="c1"># mask = border_mask(images, border_ratio=0.3)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">random_mask</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputando las imágenes enmascaradas...&quot;</span><span class="p">)</span>
<span class="c1"># Realizar la imputación</span>
<span class="n">imputed_images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_predictor_corrector_imputation</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
    <span class="n">image</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Mostrar resultados de imputación</span>
<span class="n">show_imputation_results</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">imputed_images</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Resultados de imputación: VP Cosine, Predictor-Corrector&quot;</span><span class="p">,</span> <span class="n">original_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">imputed_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:34:42,544 — DiffusionModel — INFO — Generando 8 muestras con 500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Imputando las imágenes enmascaradas...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_115_2.png" src="../_images/notebooks_pruebas_validacion_115_2.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Comparativa-Hiperparámetros">
<h1>Comparativa Hiperparámetros<a class="headerlink" href="#Comparativa-Hiperparámetros" title="Link to this heading"></a></h1>
<section id="SubVP-Cosine---Exponential-Integrator">
<h2>SubVP Cosine - Exponential Integrator<a class="headerlink" href="#SubVP-Cosine---Exponential-Integrator" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:35:18,086 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
<span class="ansi-green-fg">2025-05-10 23:35:18,089 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:35:18,094 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:35:18,095 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:35:18,113 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:35:18,118 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">array_imagenes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Sin hiperparámetros ajustados</span>

<span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_exponential_no</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">metricas_no_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_exponential_no</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_no_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>

<span class="c1">###### Modelo 2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión2...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span><span class="mf">0.65</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span><span class="mf">1.41</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_exponential_si</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_exponential_si</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:54:56,723 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 09:54:56,726 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:54:58,010 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 09:54:58,011 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 09:54:58,041 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:54:58,044 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:54:58,046 — DiffusionModel — INFO — Generando 6 muestras con 2000 pasos</span>
<span class="ansi-green-fg">2025-05-11 09:55:13,850 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b59b1d8d4ed14269a48db3ca13ac8e0d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:55:13,874 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3146b52202a948fd863da93e032f4eeb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d28b86ae682744dcbc53d8c8680cddb4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:55:21,743 — DiffusionModel — INFO — FID: 273.5738 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,745 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,746 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,789 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,790 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,815 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,818 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:55:21,819 — DiffusionModel — INFO — Generando 6 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 273.5738 (menor es mejor)
Configurando el modelo de difusión2...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:55:37,875 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5748e4b1ad56430e9fb96b4ac43a8882", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:55:37,899 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8ee61eef73904dcca3361f99d74d4371", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc970e3e8a384a0fb99387540f10e005", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:55:45,785 — DiffusionModel — INFO — FID: 186.7082 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 186.7082 (menor es mejor)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultado_final1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_exponential_no</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_exponential_si</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_exponential_no</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_exponential_si</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_exponential_no</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_exponential_si</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final1_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">resultado_final1</span><span class="p">,</span> <span class="n">resultado_final2</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">resultado_final1_1</span><span class="p">,</span> <span class="n">resultado_final3</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N_SAMPLES</span><span class="p">)</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">resultado_final</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot; Hiperparámetros no ajustados   |   Hiperparámetros ajustados   &quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_121_0.png" src="../_images/notebooks_pruebas_validacion_121_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sin hiperparámetros ajustados</span>

<span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Exponential Integrator (Hiperparámetros no ajustados)&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>

<span class="n">metricas_no_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_no_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:40:13,128 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 9...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_122_2.png" src="../_images/notebooks_pruebas_validacion_122_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:40:35,624 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
Recopilando imágenes reales:   0%|          | 0/1875 [00:00&lt;?, ?it/s]
<span class="ansi-green-fg">2025-05-10 23:40:35,636 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.54it/s]
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.69it/s]
<span class="ansi-green-fg">2025-05-10 23:40:44,626 — DiffusionModel — INFO — FID: 276.3390 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-10 23:40:44,627 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
Inception Score: 100%|██████████| 1/1 [00:00&lt;00:00,  1.68it/s]
<span class="ansi-green-fg">2025-05-10 23:40:45,430 — DiffusionModel — INFO — Inception Score: 1.0000 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,430 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
BPD: 100%|██████████| 1/1 [00:00&lt;00:00, 46.19it/s]
<span class="ansi-green-fg">2025-05-10 23:40:45,454 — DiffusionModel — INFO — BPD: 8.2582 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 276.3390 (menor es mejor)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span><span class="mf">0.65</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span><span class="mf">1.41</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:40:45,483 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,485 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,489 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,489 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,500 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:40:45,502 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Con hiperparámetros ajustados</span>

<span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Exponential Integrator (Hiperparámetros ajustados)&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_exponential</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_exponential</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:41:06,099 — DiffusionModel — INFO — Generando 12 muestras con 2500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 9...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_124_2.png" src="../_images/notebooks_pruebas_validacion_124_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:41:28,215 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
Recopilando imágenes reales:   0%|          | 0/1875 [00:00&lt;?, ?it/s]
<span class="ansi-green-fg">2025-05-10 23:41:28,247 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.50it/s]
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.68it/s]
<span class="ansi-green-fg">2025-05-10 23:41:35,806 — DiffusionModel — INFO — FID: 175.6573 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-10 23:41:35,807 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
Inception Score: 100%|██████████| 1/1 [00:00&lt;00:00,  1.59it/s]
<span class="ansi-green-fg">2025-05-10 23:41:36,632 — DiffusionModel — INFO — Inception Score: 1.0000 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,633 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
BPD: 100%|██████████| 1/1 [00:00&lt;00:00, 49.22it/s]
<span class="ansi-green-fg">2025-05-10 23:41:36,656 — DiffusionModel — INFO — BPD: 12.6229 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 175.6573 (menor es mejor)
</pre></div></div>
</div>
</section>
<section id="SubVP-Cosine-Flow-ODE">
<h2>SubVP Cosine Flow ODE<a class="headerlink" href="#SubVP-Cosine-Flow-ODE" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">array_imagenes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Sin hiperparámetros ajustados</span>

<span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_flow_ode_no</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_flow_ode_no</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span><span class="mf">0.58</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span><span class="mf">1.46</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_flow_ode_si</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_flow_ode_si</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:51:59,155 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,156 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,207 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,208 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,233 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,236 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:51:59,238 — DiffusionModel — INFO — Generando 6 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:52:24,131 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d5a5ddca24b641b98617325c42fd62a9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:52:24,158 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b78794cb1b754630b4edde2a5d334e51", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c312e4df8be341a8a1232c4976dae389", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:52:32,008 — DiffusionModel — INFO — FID: 338.9528 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,010 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,011 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,046 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,047 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,071 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,073 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 09:52:32,075 — DiffusionModel — INFO — Generando 6 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 338.9528 (menor es mejor)
Configurando el modelo de difusión...
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:52:56,556 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d89d2346217b4a6f8f67693b5721fec6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:52:56,585 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1d29be6662b4467faac5e1eee9338382", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "71593c0fe67b49b6b0a1fce1996b1d79", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 09:53:04,091 — DiffusionModel — INFO — FID: 211.0881 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 211.0881 (menor es mejor)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultado_final1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_flow_ode_no</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_flow_ode_si</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_flow_ode_no</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_flow_ode_si</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">generated_images_subvp_cosine_flow_ode_no</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">generated_images_subvp_cosine_flow_ode_si</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final1_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">resultado_final1</span><span class="p">,</span> <span class="n">resultado_final2</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">resultado_final</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">resultado_final1_1</span><span class="p">,</span> <span class="n">resultado_final3</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N_SAMPLES</span><span class="p">)</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">resultado_final</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot; Hiperparámetros no ajustados   |   Hiperparámetros ajustados   &quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_128_0.png" src="../_images/notebooks_pruebas_validacion_128_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[95]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:41:36,665 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,666 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,671 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,672 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,685 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:41:36,687 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[96]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Flow ODE (Hiperparámetros sin ajustar)&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:41:36,710 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_130_2.png" src="../_images/notebooks_pruebas_validacion_130_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:42:09,303 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
Recopilando imágenes reales:   0%|          | 0/1875 [00:00&lt;?, ?it/s]
<span class="ansi-green-fg">2025-05-10 23:42:09,334 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.65it/s]
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.70it/s]
<span class="ansi-green-fg">2025-05-10 23:42:16,525 — DiffusionModel — INFO — FID: 310.5046 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 310.5046 (menor es mejor)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span><span class="mf">0.58</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span><span class="mf">1.46</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:42:16,537 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
<span class="ansi-green-fg">2025-05-10 23:42:16,539 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-10 23:42:16,547 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-10 23:42:16,548 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-10 23:42:16,566 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-10 23:42:16,569 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span> <span class="c1"># return_sequence = True para todo el proceso</span>
<span class="p">)</span>
<span class="c1"># Mostrar imágenes generadas</span>
<span class="n">show_images</span><span class="p">(</span><span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Dígitos generados con SubVP Cosine: Flow ODE (Hiperparámetros ajustados)&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>

<span class="n">metricas_hiperparametros</span> <span class="o">=</span> <span class="n">diffusion_model_subvp_cosine_flow_ode</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_subvp_cosine_flow_ode</span><span class="p">,</span>
    <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados de calidad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FID: </span><span class="si">{</span><span class="n">metricas_hiperparametros</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (menor es mejor)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:42:16,580 — DiffusionModel — INFO — Generando 12 muestras con 2000 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 3...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_132_2.png" src="../_images/notebooks_pruebas_validacion_132_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-10 23:42:49,706 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
Recopilando imágenes reales:   0%|          | 0/1875 [00:00&lt;?, ?it/s]
<span class="ansi-green-fg">2025-05-10 23:42:49,739 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.67it/s]
Extract Inception features: 100%|██████████| 1/1 [00:00&lt;00:00,  1.65it/s]
<span class="ansi-green-fg">2025-05-10 23:42:57,129 — DiffusionModel — INFO — FID: 253.4739 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Resultados de calidad:
FID: 253.4739 (menor es mejor)
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Comparación-métricas-según-número-de-épocas-entrenamiento">
<h1>Comparación métricas según número de épocas entrenamiento<a class="headerlink" href="#Comparación-métricas-según-número-de-épocas-entrenamiento" title="Link to this heading"></a></h1>
<section id="id17">
<h2>VE<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;probability_flow_ode&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:01:42,956 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entrenar el modelo solo si no ha sido ya entrenado</span>

<span class="c1"># Configurar parámetros</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">N_EPOCHS</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">CHECKPOINT_INTERVAL</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entrenando el modelo por </span><span class="si">{</span><span class="n">N_EPOCHS</span><span class="si">}</span><span class="s2"> epochs...&quot;</span><span class="p">)</span>

<span class="c1"># Función para mostrar el progreso del entrenamiento</span>
<span class="k">def</span><span class="w"> </span><span class="nf">training_callback</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Entrenar el modelo</span>
<span class="n">training_history</span> <span class="o">=</span> <span class="n">diffusion_model_ve</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="n">N_EPOCHS</span><span class="p">,</span>
    <span class="n">lr</span><span class="o">=</span><span class="n">LR</span><span class="p">,</span>
    <span class="n">checkpoint_interval</span><span class="o">=</span><span class="n">CHECKPOINT_INTERVAL</span><span class="p">,</span>
    <span class="n">callback</span><span class="o">=</span><span class="n">training_callback</span><span class="p">,</span>
    <span class="n">model_file_name</span> <span class="o">=</span> <span class="s2">&quot;ve_sde&quot;</span>
<span class="p">)</span>
<span class="n">plot_training_history</span><span class="p">(</span><span class="n">training_history</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pérdida del modelo de difusión&quot;</span><span class="p">)</span>

<span class="n">lista_loss</span> <span class="o">=</span> <span class="p">[</span><span class="n">training_history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
    <span class="nb">range</span><span class="p">(</span><span class="n">CHECKPOINT_INTERVAL</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]),</span> <span class="n">CHECKPOINT_INTERVAL</span><span class="p">)]</span>
<span class="c1"># guardamos la pérdida</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:01:43,315 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:01:43,316 — DiffusionModel — INFO — Iniciando entrenamiento por 50 epochs</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Entrenando el modelo por 50 epochs...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0bf952d2dbf14c9682b5e6f124c90bc1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b7515849de2f4dbdabcc6396ab07e269", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:02:19,248 — DiffusionModel — INFO — Epoch 1/50, Loss: 191.493827</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1, Loss: 191.493827
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dc29e9d386f2469f82bdf311a58dedef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:02:50,919 — DiffusionModel — INFO — Epoch 2/50, Loss: 68.243618</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 2, Loss: 68.243618
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "71857b76d8a74c3bb972dea9290b6389", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:03:20,570 — DiffusionModel — INFO — Epoch 3/50, Loss: 56.092863</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 3, Loss: 56.092863
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dc42f591162b42ee850a6cafe8f4416b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:03:50,266 — DiffusionModel — INFO — Epoch 4/50, Loss: 48.362448</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 4, Loss: 48.362448
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dbdaeab2c5a64399bf5887e8104df874", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:04:19,937 — DiffusionModel — INFO — Epoch 5/50, Loss: 44.334034</span>
<span class="ansi-green-fg">2025-05-11 10:04:20,000 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_5.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 5, Loss: 44.334034
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "db7df62e447040adb129f2a1aa83fa3e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:04:49,677 — DiffusionModel — INFO — Epoch 6/50, Loss: 41.371087</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 6, Loss: 41.371087
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1ed870e6112749979d16b3e5a0dac18e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:05:19,285 — DiffusionModel — INFO — Epoch 7/50, Loss: 38.794575</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 7, Loss: 38.794575
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "001762514b1c4d67bdc5363ca6b53344", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:05:51,840 — DiffusionModel — INFO — Epoch 8/50, Loss: 37.346746</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 8, Loss: 37.346746
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9725337458ce4f868438f00b9a51a8a3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:06:24,753 — DiffusionModel — INFO — Epoch 9/50, Loss: 36.380513</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 9, Loss: 36.380513
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a062c2447ae644cb95aec2f5594ce002", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:06:57,950 — DiffusionModel — INFO — Epoch 10/50, Loss: 35.361647</span>
<span class="ansi-green-fg">2025-05-11 10:06:58,003 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_10.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 10, Loss: 35.361647
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6ff92b25a6b54e919441031474a3ab26", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:07:31,146 — DiffusionModel — INFO — Epoch 11/50, Loss: 34.419354</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 11, Loss: 34.419354
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "753fea0f7ce942299f3cc437f488fcab", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:08:00,769 — DiffusionModel — INFO — Epoch 12/50, Loss: 33.966261</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 12, Loss: 33.966261
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "61085e0d2f6d4d68b8cb8811c249427c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:08:30,441 — DiffusionModel — INFO — Epoch 13/50, Loss: 33.362360</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 13, Loss: 33.362360
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1f0631b78048400789196c76331b5b30", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:09:00,130 — DiffusionModel — INFO — Epoch 14/50, Loss: 32.259214</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 14, Loss: 32.259214
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "684067b9a8e04072979f9380e16e5fc8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:09:29,858 — DiffusionModel — INFO — Epoch 15/50, Loss: 32.043213</span>
<span class="ansi-green-fg">2025-05-11 10:09:29,934 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_15.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 15, Loss: 32.043213
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e0402affec33491bbf652534d2f9d44e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:09:59,427 — DiffusionModel — INFO — Epoch 16/50, Loss: 31.940842</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 16, Loss: 31.940842
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "33ad9aa0ccd0444aa97b791c1964bc6e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:10:28,939 — DiffusionModel — INFO — Epoch 17/50, Loss: 31.275172</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 17, Loss: 31.275172
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2589d2f9220d4d4c9947b09409eceb47", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:10:58,643 — DiffusionModel — INFO — Epoch 18/50, Loss: 30.990980</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 18, Loss: 30.990980
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "505499f080894f68a0739750403adf9e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:11:28,375 — DiffusionModel — INFO — Epoch 19/50, Loss: 30.728299</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 19, Loss: 30.728299
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "53af74d99d894bc4911ff31ef3e207d9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:11:57,881 — DiffusionModel — INFO — Epoch 20/50, Loss: 30.095166</span>
<span class="ansi-green-fg">2025-05-11 10:11:57,939 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_20.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 20, Loss: 30.095166
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "da8dad8713d94df39fa136775f7dab6f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:12:27,412 — DiffusionModel — INFO — Epoch 21/50, Loss: 29.881794</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 21, Loss: 29.881794
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f217c807c5a94f2ea9d82d70ce1d7273", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:12:57,066 — DiffusionModel — INFO — Epoch 22/50, Loss: 30.107171</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 22, Loss: 30.107171
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "49b18a774c2040a296312e348086ed1f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:13:26,741 — DiffusionModel — INFO — Epoch 23/50, Loss: 30.063264</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 23, Loss: 30.063264
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cb5eb2b578b74af4842a487d57cbef86", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:13:56,276 — DiffusionModel — INFO — Epoch 24/50, Loss: 29.506251</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 24, Loss: 29.506251
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "85a1c9da3e744542a0e177f5df52037a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:14:25,682 — DiffusionModel — INFO — Epoch 25/50, Loss: 29.075776</span>
<span class="ansi-green-fg">2025-05-11 10:14:25,747 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_25.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 25, Loss: 29.075776
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "881d8a85ebf140d2a1d023e4ff3f0098", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:14:52,262 — DiffusionModel — INFO — Epoch 26/50, Loss: 29.279006</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 26, Loss: 29.279006
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7d7ff3d0572a47b38e9ab14cdf381309", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:15:14,112 — DiffusionModel — INFO — Epoch 27/50, Loss: 28.634082</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 27, Loss: 28.634082
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a8fd05c7493641a189135ed1bb567e2c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:15:35,962 — DiffusionModel — INFO — Epoch 28/50, Loss: 28.970432</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 28, Loss: 28.970432
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3a99f72e81c488f915dc0b6149396e4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:15:57,849 — DiffusionModel — INFO — Epoch 29/50, Loss: 28.579649</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 29, Loss: 28.579649
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d51490737d249f7bae12ffa63d66475", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:16:20,132 — DiffusionModel — INFO — Epoch 30/50, Loss: 28.481536</span>
<span class="ansi-green-fg">2025-05-11 10:16:20,169 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_30.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 30, Loss: 28.481536
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "582ab52c4ad24920b9a13eb4d00378bc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:16:42,257 — DiffusionModel — INFO — Epoch 31/50, Loss: 28.126905</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 31, Loss: 28.126905
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ec346cc378a845d9b78762c45414b244", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:17:04,183 — DiffusionModel — INFO — Epoch 32/50, Loss: 28.135627</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 32, Loss: 28.135627
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1acd85415cf94daea5148e53990e9801", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:17:26,178 — DiffusionModel — INFO — Epoch 33/50, Loss: 27.962709</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 33, Loss: 27.962709
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0e5c0fcc42b84f3fb820e752be982de1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:17:48,169 — DiffusionModel — INFO — Epoch 34/50, Loss: 27.833009</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 34, Loss: 27.833009
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2dff8cee0dc749c2a63a0b4fdfc6f513", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:18:10,021 — DiffusionModel — INFO — Epoch 35/50, Loss: 27.766778</span>
<span class="ansi-green-fg">2025-05-11 10:18:10,056 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_35.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 35, Loss: 27.766778
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac33726a9e8542f782b234c4c96b8345", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:18:31,825 — DiffusionModel — INFO — Epoch 36/50, Loss: 27.704544</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 36, Loss: 27.704544
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "90fbcf326aba43a49ce3aa44c8487696", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:18:53,631 — DiffusionModel — INFO — Epoch 37/50, Loss: 27.514175</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 37, Loss: 27.514175
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ce63e54a368840c38c42453af243789f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:19:15,411 — DiffusionModel — INFO — Epoch 38/50, Loss: 27.510144</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 38, Loss: 27.510144
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9b03312d72794e4eb1012ce4f185a7a5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:19:37,242 — DiffusionModel — INFO — Epoch 39/50, Loss: 27.481744</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 39, Loss: 27.481744
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a7360b1cc3c54e378e635aaa94597699", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:19:59,085 — DiffusionModel — INFO — Epoch 40/50, Loss: 27.023917</span>
<span class="ansi-green-fg">2025-05-11 10:19:59,121 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_40.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 40, Loss: 27.023917
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "04ba26b1c0354060ada0f23542ec405d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:20:20,913 — DiffusionModel — INFO — Epoch 41/50, Loss: 27.030900</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 41, Loss: 27.030900
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9075345cde1c4341995b42b13cde6094", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:20:42,618 — DiffusionModel — INFO — Epoch 42/50, Loss: 27.243224</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 42, Loss: 27.243224
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "03c89aff19e241a68355b47020d39e2f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:21:04,465 — DiffusionModel — INFO — Epoch 43/50, Loss: 26.625057</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 43, Loss: 26.625057
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c762945b82342569733a667b726af5e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:21:26,617 — DiffusionModel — INFO — Epoch 44/50, Loss: 26.693212</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 44, Loss: 26.693212
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d28ddacd07f34fba863df42b23dac037", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:21:48,435 — DiffusionModel — INFO — Epoch 45/50, Loss: 26.841978</span>
<span class="ansi-green-fg">2025-05-11 10:21:48,471 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_45.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 45, Loss: 26.841978
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7e50cf7b05834a368187834c3a32d3e8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:22:10,384 — DiffusionModel — INFO — Epoch 46/50, Loss: 26.520825</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 46, Loss: 26.520825
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0deeccf96a8b495d9a8b27b444c772d4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:22:32,269 — DiffusionModel — INFO — Epoch 47/50, Loss: 26.473682</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 47, Loss: 26.473682
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a98b2bdd847f47c994b21c69a644b0ed", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:22:54,060 — DiffusionModel — INFO — Epoch 48/50, Loss: 26.597832</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 48, Loss: 26.597832
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "da7724b54cb8430990713100f3b078a1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:23:15,896 — DiffusionModel — INFO — Epoch 49/50, Loss: 26.441001</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 49, Loss: 26.441001
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1f3ca5e8c0d947098c124a575fc0975e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:23:37,733 — DiffusionModel — INFO — Epoch 50/50, Loss: 26.368005</span>
<span class="ansi-green-fg">2025-05-11 10:23:37,765 — DiffusionModel — INFO — Checkpoint guardado en ../checkpoints\ve_sde_checkpoint_epoch_50.pt</span>
<span class="ansi-green-fg">2025-05-11 10:23:37,777 — DiffusionModel — INFO — Modelo final guardado en ../checkpoints\ve_sde.pt</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 50, Loss: 26.368005
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_136_153.png" src="../_images/notebooks_pruebas_validacion_136_153.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_modelos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">nombre_modelo</span> <span class="o">=</span> <span class="s2">&quot;ve_sde_checkpoint_epoch_&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre_modelo</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CHECKPOINT_INTERVAL</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.pt&quot;</span>
    <span class="n">lista_modelos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nombre</span><span class="p">)</span>

<span class="n">lista_modelos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ve_sde.pt&quot;</span><span class="p">)</span>

<span class="n">lista_N_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">]</span> <span class="c1"># Poner los n_steps a probar</span>
<span class="n">lista_metricas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="k">for</span> <span class="n">N_STEPS</span> <span class="ow">in</span> <span class="n">lista_N_steps</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">lista_modelos</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
        <span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
        <span class="n">diffusion_model_ve_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
            <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
            <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;euler_maruyama&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">path_modelo</span> <span class="o">=</span> <span class="s2">&quot;../checkpoints/&quot;</span><span class="o">+</span> <span class="n">modelo</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">path_modelo</span><span class="p">)</span>
        <span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="n">path_modelo</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="n">generated_images_ve_euler</span><span class="p">,</span> <span class="n">condition_used</span><span class="o">=</span> <span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
            <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
            <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
            <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">metricas</span> <span class="o">=</span> <span class="n">diffusion_model_ve_euler</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
        <span class="n">generated_samples</span><span class="o">=</span><span class="n">generated_images_ve_euler</span><span class="p">,</span>
        <span class="n">real_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">,</span> <span class="s2">&quot;is&quot;</span><span class="p">,</span> <span class="s2">&quot;bpd&quot;</span><span class="p">],</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">lista_metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:31,661 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,661 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_5.pt</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,711 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,711 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,727 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,729 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:31,732 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_5.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:34,342 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4c039553e18f45e79bb883d46e23e951", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:34,378 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "01efec7011984f6581d5dd9538024443", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2e04e3f1f4a9475899d072cbc851756c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:39,994 — DiffusionModel — INFO — FID: 125.3426 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:39,995 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "24829992b46546acaeb0d09bd8e37d6d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:41,009 — DiffusionModel — INFO — Inception Score: 1.5219 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,009 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "26d3559e55f745bb9cc3e887a8bcc7f0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:41,082 — DiffusionModel — INFO — BPD: 2.7240 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,095 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,096 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_10.pt</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,153 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,153 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,167 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,170 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:41,172 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_10.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:43,634 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "512ed639c2594bc8b3db67f50562dfe2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:43,685 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "60268f13b8ef4deab94689b8b872f91f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "71c3ed030f8148afa635d264300f9ac7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:49,683 — DiffusionModel — INFO — FID: 133.8032 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:49,684 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7191b6c13e7f40f1aaaf9d9aa58e44b4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:50,790 — DiffusionModel — INFO — Inception Score: 1.5528 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,791 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc826200e6c94b0096788bb6ca09c6cc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:50,827 — DiffusionModel — INFO — BPD: 2.6237 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,840 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,841 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_15.pt</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,889 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,890 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,902 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,904 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:30:50,906 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_15.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:53,258 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7da699e4ecc646829370ad692552a01b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:53,302 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "15908928276e44f5a972805bc1ca4562", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4c6e578b08f24aaa9df8ebdc1e87e4d6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:58,889 — DiffusionModel — INFO — FID: 138.9722 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:58,890 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6942121e3324c4d80dfe471c1f2024b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:30:59,988 — DiffusionModel — INFO — Inception Score: 1.6020 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:30:59,989 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e9e27f6d2d0548b7b225bb03e2567ae3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:00,017 — DiffusionModel — INFO — BPD: 3.1323 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,031 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,032 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_20.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,083 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,084 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,094 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,096 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:00,098 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_20.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:02,428 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "22c9b7fd99e84441887d991376077bde", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:02,471 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8ff3ee7439124fdb84edb90a413afcf8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "91cda1526944454e970df59232aa1507", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:07,772 — DiffusionModel — INFO — FID: 134.5523 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:07,773 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "eb1499b7ac684c46af039a93fcbcad5c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:08,800 — DiffusionModel — INFO — Inception Score: 1.6009 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,800 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ec50c3da91f146e697efde61fc01ca4a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:08,821 — DiffusionModel — INFO — BPD: 3.1608 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,832 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,833 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_25.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,876 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,876 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,885 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,887 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:08,888 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_25.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:11,168 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8faf553058a74273a28c9c8f959a32ed", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:11,203 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "33922ad689664a5898f627d4f11b788e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "abdd7140c65d4a739a2472c977e1a553", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:16,606 — DiffusionModel — INFO — FID: 136.0546 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:16,607 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "252e49dd3e28401e88bbc37f3e148263", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:17,604 — DiffusionModel — INFO — Inception Score: 1.6213 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,605 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "42ff13c8f8f04047a1f9b09889374290", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:17,626 — DiffusionModel — INFO — BPD: 2.7332 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,635 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,637 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_30.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,683 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,684 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,691 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,693 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:17,694 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_30.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:20,006 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "52df373b784647eb97d629f694115266", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:20,041 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b4ec388a39d84d1f9b591558623ffbf3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd4c1515afdb4179980bd5949634ceb9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:25,352 — DiffusionModel — INFO — FID: 143.3980 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:25,353 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8b1790e4c6eb42b3ba89a347e0dc560c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:26,397 — DiffusionModel — INFO — Inception Score: 1.5276 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,398 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "baa2c4cf613a477da1aab2f19c8d3583", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:26,421 — DiffusionModel — INFO — BPD: 2.5221 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,433 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,435 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_35.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,471 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,471 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,479 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,482 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:26,483 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_35.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:28,792 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0f6cc3f784504b229ae98acd6d9a62a1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:28,828 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "350a868a34344c5084bc1f305ae88678", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "853925ba5523444bac75fba1ed690d7d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:34,114 — DiffusionModel — INFO — FID: 137.6525 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:34,115 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7b47a90c12e24472b6eca1b53c799cef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:35,179 — DiffusionModel — INFO — Inception Score: 1.6267 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,180 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "369e5ae46881428baaa96e7f34acb0c4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:35,203 — DiffusionModel — INFO — BPD: 2.4518 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,215 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,216 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_40.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,257 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,258 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,269 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,271 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:35,272 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_40.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:37,569 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d377eda88a9a4a3b98cac9d759da6029", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:37,608 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "65c9790853af4e77b80f91a210967cc3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a4c8da0da98d423c8d217ba422317bd0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:43,055 — DiffusionModel — INFO — FID: 135.6837 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:43,055 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "473f002b7d0a470a9fc8eeef441670a0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:44,007 — DiffusionModel — INFO — Inception Score: 1.7520 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,007 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ea648bedec304104aafa3cda8bf33422", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:44,030 — DiffusionModel — INFO — BPD: 2.2584 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,042 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,043 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde_checkpoint_epoch_45.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,083 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,084 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,092 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,094 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:44,095 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde_checkpoint_epoch_45.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:46,398 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6eeb045a134e4f31bc0ff2eabb7d6ca4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:46,437 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "51c2f8fb400c48eaa72e66f65b3a39ab", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "150483a8b4894394a5d6a7b04f079ccb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:51,905 — DiffusionModel — INFO — FID: 164.6375 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:51,906 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c0552a8c1b0a490587c3bafe957c680e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:52,982 — DiffusionModel — INFO — Inception Score: 1.5401 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:52,983 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ae99f1c49b88488cb307511d5d1010f5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:53,010 — DiffusionModel — INFO — BPD: 2.4288 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,023 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,024 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,046 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,047 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,060 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,063 — DiffusionModel — INFO — Modelo cargado correctamente</span>
<span class="ansi-green-fg">2025-05-11 10:31:53,064 — DiffusionModel — INFO — Generando 250 muestras con 250 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
../checkpoints/ve_sde.pt
Generando imágenes del dígito 5...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:55,366 — DiffusionModel — INFO — Recopilando imágenes reales para comparación</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dc3442e7a7dd4e9cbb735235fb301388", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:31:55,409 — DiffusionModel — INFO — Calculando FID (Fréchet Inception Distance)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "97d21539445c4549a042cee776427f17", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ddf0fb5ca2dd4649b8ae4a5a4764c7f2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:32:00,964 — DiffusionModel — INFO — FID: 136.8576 (menor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:32:00,965 — DiffusionModel — INFO — Calculando IS (Inception Score)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1e0bf2bb520a4c10865ead01a98fc9da", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:32:01,992 — DiffusionModel — INFO — Inception Score: 1.7077 (mayor es mejor)</span>
<span class="ansi-green-fg">2025-05-11 10:32:01,993 — DiffusionModel — INFO — Calculando BPD (Bits Per Dimension)...</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "99808155c3db4866a9266f07fbf5d825", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 10:32:02,023 — DiffusionModel — INFO — BPD: 2.1716 (menor es mejor)</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lista_metricas</span><span class="p">)</span>

<span class="c1"># Añadimos una columna de época (índice de la lista)</span>
<span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;época&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lista_loss</span> <span class="c1"># df.insert(0, &#39;loss&#39;, lista_loss)</span>

<span class="c1"># Mostramos la tabla</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 época        fid       is      bpd      loss
     5 125.342554 1.521904 2.724024 44.334034
    10 133.803187 1.552782 2.623744 35.361647
    15 138.972249 1.601978 3.132272 32.043213
    20 134.552287 1.600858 3.160797 30.095166
    25 136.054623 1.621306 2.733150 29.075776
    30 143.398044 1.527607 2.522136 28.481536
    35 137.652493 1.626705 2.451809 27.766778
    40 135.683686 1.751970 2.258361 27.023917
    45 164.637529 1.540138 2.428812 26.841978
    50 136.857575 1.707701 2.171607 26.368005
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;fid&quot;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 época        fid       is      bpd      loss
     5 136.857575 1.521904 2.724024 44.334034
    10 164.637529 1.552782 2.623744 35.361647
    15 135.683686 1.601978 3.132272 32.043213
    20 137.652493 1.600858 3.160797 30.095166
    25 143.398044 1.621306 2.733150 29.075776
    30 136.054623 1.527607 2.522136 28.481536
    35 134.552287 1.626705 2.451809 27.766778
    40 138.972249 1.751970 2.258361 27.023917
    45 133.803187 1.540138 2.428812 26.841978
    50 125.342554 1.707701 2.171607 26.368005
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Crear los subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Graficar cada variable en su respectivo subplot</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;época&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Loss vs Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;época&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FID vs Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;FID&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;época&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;is&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;IS vs Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IS&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;época&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;bpd&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BPD vs Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Época&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;BPD&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># Ajustar el layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_141_0.png" src="../_images/notebooks_pruebas_validacion_141_0.png" />
</div>
</div>
</section>
</section>
<section id="Pruebas-Imputation">
<h1>Pruebas Imputation<a class="headerlink" href="#Pruebas-Imputation" title="Link to this heading"></a></h1>
<p>Un ejemplo usando VE</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">8</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_flow_ode_imputation</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;probability_flow_ode&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_ve_flow_ode_imputation</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:04:13,977 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cpu</span>
<span class="ansi-green-fg">2025-05-11 00:04:13,978 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-11 00:04:13,981 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 00:04:13,982 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 00:04:14,003 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 00:04:14,008 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">generative_diffusion.controllable</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_mask</span>

<span class="c1"># Obtener un batch de imágenes del dataloader</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[:</span><span class="n">N_SAMPLES</span><span class="p">]</span>

<span class="c1"># mask = center_square_mask(images, keep_ratio=0.4)</span>
<span class="c1"># mask = border_mask(images, border_ratio=0.3)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">random_mask</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputando las imágenes enmascaradas...&quot;</span><span class="p">)</span>
<span class="c1"># Realizar la imputación</span>
<span class="n">imputed_images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diffusion_model_ve_flow_ode_imputation</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
    <span class="n">image</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Mostrar resultados de imputación</span>
<span class="n">show_imputation_results</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">imputed_images</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Resultados de imputación: VE, Flow ODE&quot;</span><span class="p">,</span> <span class="n">original_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">imputed_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:08:59,118 — DiffusionModel — INFO — Generando 8 muestras con 500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Imputando las imágenes enmascaradas...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_145_2.png" src="../_images/notebooks_pruebas_validacion_145_2.png" />
</div>
</div>
</section>
<section id="Visualizar-proceso-de-eliminación-de-ruido">
<h1>Visualizar proceso de eliminación de ruido<a class="headerlink" href="#Visualizar-proceso-de-eliminación-de-ruido" title="Link to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_ve_flow_ode</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;ve_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s2">&quot;probability_flow_ode&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:12,198 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_ve_flow_ode</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/ve_sde.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:13,003 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/ve_sde.pt</span>
<span class="ansi-green-fg">2025-05-11 00:28:14,248 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 00:28:14,249 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 00:28:14,268 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 00:28:14,271 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">return_sequence1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">diffusion_model_ve_flow_ode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
    <span class="n">return_sequence</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:30:20,236 — DiffusionModel — INFO — Generando 1 muestras con 1500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_linear_exponential</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;exponential_integrator&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:29,184 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_vp_linear_exponential</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:29,217 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-11 00:28:29,228 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 00:28:29,229 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 00:28:29,245 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 00:28:29,248 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">return_sequence2</span><span class="p">,</span> <span class="n">condition</span>  <span class="o">=</span> <span class="n">diffusion_model_vp_linear_exponential</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
    <span class="n">return_sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:29,260 — DiffusionModel — INFO — Generando 1 muestras con 1500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_vp_cosine_predictor</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;vp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;predictor_corrector&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:34,985 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_vp_cosine_predictor</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/vp_sde_cosine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:34,993 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/vp_sde_cosine.pt</span>
<span class="ansi-green-fg">2025-05-11 00:28:35,009 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 00:28:35,010 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 00:28:35,021 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 00:28:35,024 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">return_sequence3</span> <span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">diffusion_model_vp_cosine_predictor</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
    <span class="n">return_sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:28:35,031 — DiffusionModel — INFO — Generando 1 muestras con 1500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configurando el modelo de difusión...&quot;</span><span class="p">)</span>
<span class="c1"># Crear modelo de difusión utilizando el ModelFactory</span>
<span class="n">diffusion_model_subvp_linear_euler</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">score_model_class</span><span class="o">=</span><span class="n">ScoreNet</span><span class="p">,</span>
    <span class="n">is_conditional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sde_name</span><span class="o">=</span><span class="s1">&#39;subvp_sde&#39;</span><span class="p">,</span>
    <span class="n">sampler_name</span><span class="o">=</span><span class="s1">&#39;euler_maruyama&#39;</span><span class="p">,</span>
    <span class="n">scheduler_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="n">sde_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coef_beta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;coef_score&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:29:28,646 — DiffusionModel — INFO — Modelo de difusión inicializado en dispositivo: cuda</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Configurando el modelo de difusión...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar un modelo pre-entrenado (asumiendo que ya tienes uno)</span>
<span class="n">diffusion_model_subvp_linear_euler</span><span class="o">.</span><span class="n">load_score_model</span><span class="p">(</span><span class="s2">&quot;../checkpoints/subvp_sde_linear.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:29:28,680 — DiffusionModel — INFO — Cargando modelo desde ../checkpoints/subvp_sde_linear.pt</span>
<span class="ansi-green-fg">2025-05-11 00:29:28,693 — DiffusionModel — INFO — Forma de datos cargada: torch.Size([3, 28, 28])</span>
<span class="ansi-green-fg">2025-05-11 00:29:28,694 — DiffusionModel — INFO — Parámetros del modelo actualizados desde checkpoint</span>
<span class="ansi-green-fg">2025-05-11 00:29:28,709 — DiffusionModel — INFO — Modelo de score inicializado correctamente</span>
<span class="ansi-green-fg">2025-05-11 00:29:28,711 — DiffusionModel — INFO — Modelo cargado correctamente</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIGIT_CLASS</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Parámetros para generación</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="c1"># Crear tensor de condición para el dígito especificado</span>
<span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">DIGIT_CLASS</span><span class="p">]</span><span class="o">*</span><span class="n">N_SAMPLES</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generando imágenes del dígito </span><span class="si">{</span><span class="n">DIGIT_CLASS</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Generar imágenes</span>
<span class="n">return_sequence4</span><span class="p">,</span> <span class="n">_</span>  <span class="o">=</span> <span class="n">diffusion_model_subvp_linear_euler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span>
    <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS</span><span class="p">,</span>
    <span class="n">return_sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">2025-05-11 00:29:28,719 — DiffusionModel — INFO — Generando 1 muestras con 1500 pasos</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generando imágenes del dígito 7...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">return_sequences2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">return_sequence1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_sequence2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">return_sequences1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">return_sequence4</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_sequence3</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">return_sequences3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">return_sequences1</span><span class="p">,</span> <span class="n">return_sequences2</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">titulos</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Euler-Maruyama: SubVP-Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Predictor-Corrector: VP-Cosine&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow ODE: VE&quot;</span><span class="p">,</span> <span class="s2">&quot;Exponential Integrator: VP-Linear&quot;</span><span class="p">]</span>

<span class="n">plot_image_evolution</span><span class="p">(</span><span class="n">return_sequences3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="mi">1375</span><span class="p">,</span> <span class="mi">1450</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">titulos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.6871574..4.2092285].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.9791567..5.255584].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.428842..4.94057].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-3.5634573..6.378902].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.6697056..6.6568675].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.2376008..6.554372].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.5343767..5.996207].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.3456641..5.062339].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0570449..4.485384].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.4203208..4.0642486].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.19641292..3.809372].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-3.434319..3.649656].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-4.376332..3.2071862].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-3.1571696..3.2443976].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.5725424..2.6600327].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.3205352..1.9109294].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.6042104..1.9518075].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.2344568..1.4356563].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.7329807..1.1505793].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.4536025..1.0301685].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.24714608..0.9615313].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04576432..0.91788566].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.1510355..2.523991].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.4468712..1.8329164].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0204519..1.3261561].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.78772193..0.9524584].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6050546..0.694238].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.5258695..0.63047874].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.45143855..0.5795986].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.37809458..0.53872263].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.317808..0.5106796].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.23873289..0.47426865].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.090658665..0.41519943].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-3.2001257..3.2909346].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-3.8984706..3.015986].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-5.670103..4.395403].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-7.0419936..4.947294].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-6.065459..4.1635466].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-5.415848..4.332168].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-4.2196474..3.8871546].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.809376..3.114067].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.0706582..2.2681336].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.2356105..1.0884721].
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.19887353..0.60090786].
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
a
a
a
a
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 1800x800 with 44 Axes&gt;,
 array([[&lt;Axes: title={&#39;left&#39;: &#39;Euler-Maruyama: SubVP-Linear&#39;}&gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: title={&#39;left&#39;: &#39;Predictor-Corrector: VP-Cosine&#39;}&gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: title={&#39;left&#39;: &#39;Flow ODE: VE&#39;}&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: title={&#39;left&#39;: &#39;Exponential Integrator: VP-Linear&#39;}&gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;]], dtype=object))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pruebas_validacion_159_3.png" src="../_images/notebooks_pruebas_validacion_159_3.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="simple_demo.html" class="btn btn-neutral float-left" title="Generative Diffusion: Entrenamiento y Generación con MNIST a Color" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2025, Manuel Muñoz.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>